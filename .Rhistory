h<-50 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-2 #completion multiplier
d<-3 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-50 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-2 #completion multiplier
d<-10 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-50 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-20 #completion multiplier
d<-10 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-50 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-10 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-50 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-50 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-40 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-70 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-120 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-1 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.5 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-1.85 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.5 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-2 #passing1d multiplier
g<-1.5 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-1.5 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))-15.6
newqbdf[order(-newqbdf$QPM), ]
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-(((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))-15.6)
newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
capDF<-read.csv('qbcaps.csv')
capDF<-read.csv('qbcaps.csv')
capDF
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-(((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))-15.6)
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf<-merge(x=newqbdf, y=capDF, by="Passer", all.x = TRUE)
capDF<-read.csv('qbcaps.csv')
capDF$Name=capDF$Passer
capDF<-read.csv('qbcaps.csv')
capDF$Name=capDF$Passer
capDF
capDF<-read.csv('qbcaps.csv')
capDF$Name="Passer"
capDF
capDF<-read.csv('qbcaps.csv')
capDF
capDF<-read.csv('qbcaps.csv')
names(capDF)[names(capDF) == 'Name'] <- 'Passer'
capDF
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-(((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))-15.6)
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf<-merge(x=newqbdf, y=capDF, by="Passer", all.x = TRUE)
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-(((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))-15.6)
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf<-merge(x=newqbdf, y=capDF, by="Passer", all.x = TRUE)
newqbdf
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-(((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))-15.6)
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-(((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))-15.6)
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf
install.packages("dummies")
install.packages("ggplot2")
install.packages("dummies")
install.packages("stringr")
install.packages("plyr")
install.packages("dummies")
install.packages("ggplot2")
install.packages("dummies")
install.packages("stringr")
install.packages("plyr")
library(ggplot2)
library(data.table)
library(dummies)
library(stringr)
library(plyr)
setwd("C:\\Users\\Owner\\Desktop\\gitstuff\\Projects\\nflPlayByPlay")
df <- read.csv(file = "NFLPlaybyPlay2015.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
df
totalYds<-aggregate(df$ydsnet, by=list(PlayType=df$PlayType), FUN = sum)
runPassTotalYds<-totalYds[totalYds$PlayType %in% c("Run","Pass"), ]
ggplot(runPassTotalYds, aes(PlayType, x, fill=x)) +
geom_bar(position="dodge", stat = "identity") + ggtitle("Total Yards by Play Type in 2015")
qbdf<-df[ which(!is.na(df$Passer)), ]
qbdf<- dummy.data.frame(qbdf, names = c("PassOutcome","PassLength","PassLocation","TwoPointConv") , sep = ".")
qbdf<- qbdf[, !(colnames(qbdf) %in% c("Rusher","RushAttempt","RunLocation","RunGap","FieldGoalResult","FieldGoalDistance","Challenge.Replay","ChalReplayResult","Accepted.Penalty","PenalizedTeam","PenaltyType","PenalizedPlayer","Penalty.Yards","Season","X","Date","time","desc","ExPointResult","PuntResult","Drive","GameID","qtr","TimeUnder","TimeSecs","PlayTimeDiff","SideofField","yrdln","yrdline100","ydstogo","GoalToGo","posteam","DefensiveTeam","PassLength.NA","PassLocation.NA","PosTeamScore","DefTeamScore","ScoreDiff","AbsScoreDiff","PlayType","Interceptor","TwoPointConv.NA","down.NA","sp","Receiver","ReturnResult","Returner","BlockingPlayer","Tackler1","Tackler2","RecFumbTeam","RecFumbPlayer","DefTwoPoint","Sack","down","ydsnet","Safety","PlayAttempted"))]
qbdt<-setDT(qbdf)
qbdt<-qbdt[, lapply(.SD, sum, na.rm=TRUE), by=Passer ]
qbdf<-setDF(qbdt)
qbdf1<-qbdf[qbdf$PassAttempt>=400, ]
qbdf1<-qbdf1[order(-qbdf1$Yards.Gained), ]
rownames(qbdf1) <- 1:nrow(qbdf1)
qbdf1
passer<-qbdf$Passer
qbRushDF<-df[which(df$Rusher %in% passer), ]
qbRushDF<- dummy.data.frame(qbRushDF, names = c("RunLocation","RunGap") , sep = ".")
qbRushDF<- qbRushDF[, !(colnames(qbRushDF) %in% c("FieldGoalResult","FieldGoalDistance","Challenge.Replay","ChalReplayResult","Accepted.Penalty","PenalizedTeam","PenaltyType","PenalizedPlayer","Penalty.Yards","Season","X","Date","time","desc","ExPointResult","PuntResult","Drive","GameID","qtr","TimeUnder","TimeSecs","PlayTimeDiff","SideofField","yrdln","yrdline100","ydstogo","GoalToGo","posteam","DefensiveTeam","PosTeamScore","DefTeamScore","ScoreDiff","AbsScoreDiff","PlayType","Interceptor","TwoPointConv.NA","down.NA","sp","Receiver","ReturnResult","Returner","BlockingPlayer","Tackler1","Tackler2","RecFumbTeam","RecFumbPlayer","DefTwoPoint","Sack","down","ydsnet","Safety","PlayAttempted","Passer","PassAttempt","PassOutcome","PassLength","PassLocation","TwoPointConv","InterceptionThrown","RunLocation.NA","RunGap.NA","Reception"))]
qbRushDT<-setDT(qbRushDF)
qbRushDT<-qbRushDF[, lapply(.SD, sum, na.rm=TRUE), by=Rusher ]
qbRushDF<-setDF(qbRushDT)
qbRushDF<-rename(qbRushDF,c("Rusher"="Passer","Yards.Gained"="Rushing.Yards","Touchdown"="Rushing.Touchdown","FirstDown"="Rushing.FirstDown"))
qbRushDF
sackDF<-df[which(df$Sack==1), ]
rownames(sackDF) <- 1:nrow(sackDF)
for (i in 1:nrow(sackDF))
{
if (length(passer[str_detect(sackDF[i, "desc"],passer)])!=0)
{
sackDF[i, "Passer"]<-passer[str_detect(sackDF[i, "desc"],passer)][1]
}
}
sackDF<-sackDF[which(!is.na(sackDF$Passer)), ]
sackDF<-sackDF[, !(colnames(sackDF) %in% c("FieldGoalResult","FieldGoalDistance","Challenge.Replay","ChalReplayResult","Accepted.Penalty","PenalizedTeam","PenaltyType","PenalizedPlayer","Penalty.Yards","Season","X","Date","time","desc","ExPointResult","PuntResult","Drive","GameID","qtr","TimeUnder","TimeSecs","PlayTimeDiff","SideofField","yrdln","yrdline100","ydstogo","GoalToGo","posteam","DefensiveTeam","PosTeamScore","DefTeamScore","ScoreDiff","AbsScoreDiff","PlayType","Interceptor","TwoPointConv.NA","down.NA","sp","Receiver","ReturnResult","Returner","BlockingPlayer","Tackler1","Tackler2","RecFumbTeam","RecFumbPlayer","DefTwoPoint","down","ydsnet","Safety","PlayAttempted","Rusher","PassAttempt","PassOutcome","PassLength","PassLocation","TwoPointConv","InterceptionThrown","RunLocation.NA","RunGap.NA","Reception","Rusher","RushAttempt","RunLocation","RunGap","FirstDown","Touchdown","Yards.Gained"))]
sackdt<-setDT(sackDF)
sackdt<-sackdt[, lapply(.SD, sum, na.rm=TRUE), by=Passer ]
sackDF<-setDF(sackdt)
sackDF
qbdf<-rename(qbdf,c("Yards.Gained"="Passing.Yards","Touchdown"="Passing.Touchdown","FirstDown"="Passing.FirstDown"))
qbdf
newqbdf<-merge(x = qbdf, y = qbRushDF, by = "Passer", all.y = TRUE)
newqbdf$Fumble<-newqbdf$Fumble.x+newqbdf$Fumble.y
newqbdf<-newqbdf[, !(colnames(newqbdf) %in% c("Fumble.y","Fumble.x","Reception"))]
newqbdf<-merge(x = newqbdf, y = sackDF, by = "Passer", all.x = TRUE)
newqbdf$Fumble<-newqbdf$Fumble.x+newqbdf$Fumble.y
newqbdf<-newqbdf[, !(colnames(newqbdf) %in% c("Fumble.y","Fumble.x"))]
newqbdf<-newqbdf[newqbdf$PassAttempt>=300, ]
newqbdf$Plays<-newqbdf$PassAttempt+newqbdf$RushAttempt+newqbdf$Sack
newqbdf<-newqbdf[!is.na(newqbdf$Passer), ]
newqbdf
anotherQBDF<-data.frame(row.names = newqbdf$Passer)
anotherQBDF$completionRatio<-newqbdf$PassOutcome.Complete/newqbdf$PassAttempt
anotherQBDF$passingYardsPerComp<-newqbdf$Passing.Yards/newqbdf$PassOutcome.Complete
anotherQBDF$passingYardsPerAttempt<-newqbdf$Passing.Yards/newqbdf$PassAttempt
anotherQBDF$rushingYardsPerAttempt<-newqbdf$Rushing.Yards/newqbdf$RushAttempt
anotherQBDF$passFirstDownPerComp<-newqbdf$Passing.FirstDown/newqbdf$PassOutcome.Complete
anotherQBDF$rushFirstDownPerAttempt<-newqbdf$Rushing.FirstDown/newqbdf$RushAttempt
anotherQBDF$passingTouchdownPerComp<-newqbdf$Passing.Touchdown/newqbdf$PassOutcome.Complete
anotherQBDF$rushingTouchdownPerAttempt<-newqbdf$Rushing.Touchdown/newqbdf$RushAttempt
anotherQBDF$shortPassRatio<-newqbdf$PassLength.Short/newqbdf$PassAttempt
anotherQBDF$deepPassRatio<-newqbdf$PassLength.Deep/newqbdf$PassAttempt
anotherQBDF$fumblePerPlay<-newqbdf$Fumble/newqbdf$Plays
anotherQBDF$sackPerPlay<-newqbdf$Sack/newqbdf$Plays
anotherQBDF$interceptionPerAttempt<-newqbdf$InterceptionThrown/newqbdf$PassAttempt
anotherQBDF
options(max.print = .Machine$integer.max)
dM<-dist(anotherQBDF, method = "euclidean", diag = TRUE, upper = TRUE, p = 2)
dM
capDF<-read.csv('qbcaps.csv')
names(capDF)[names(capDF) == 'Name'] <- 'Passer'
capDF
quarterbackPerformanceMetric<-function(comp, att, passtd, int, fum, sck, passyd, rushyd, rushatt,rushtd)
{
performance <- (comp/att)*(passtd/(int+fum+(0.5*sck)))*(rushtd/(1.5*fum)+(.5*sck))*(0.5*passyd/comp)*(0.3*rushyd/rushatt)
return(performance)
}
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-(((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))-15.6)
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf
newqbdf<-merge(x=newqbdf, y=capDF, by="Passer", all.x = TRUE)
newqbdf
newqbdf<-merge(x=newqbdf, y=capDF, by="Passer", all.x = TRUE)
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf
newqbdf<- newqbdf[ , !(colnames(qbdf) %in% c("Cap.x","Cap.y"))]
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf
newqbdf<- newqbdf[ , !(colnames(newqbdf) %in% c("Cap.x","Cap.y"))]
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf
newqbdf<-merge(x=newqbdf, y=capDF, by="Passer", all.x = TRUE)
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
scale(newqbdf$QPM)
scape(newqbdf$Cap)
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
scale(newqbdf$QPM)
scale(newqbdf$Cap)
newqbdf
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf$sigmaQPM<-scale(newqbdf$QPM)
newqbdf$sigmaCap<-scale(newqbdf$Cap)
newqbdf
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf$sigmaQPM<-scale(newqbdf$QPM)
newqbdf$sigmaCap<-scale(newqbdf$Cap)
newqbdf$Value<-newqbdf$sigmaCap-newqbdf$sigmaQPM
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf$sigmaQPM<-scale(newqbdf$QPM)
newqbdf$sigmaCap<-scale(newqbdf$Cap)
newqbdf$Value<-newqbdf$sigmaCap-newqbdf$sigmaQPM
newqbdf
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf$sigmaQPM<-scale(newqbdf$QPM)
newqbdf$sigmaCap<-scale(newqbdf$Cap)
newqbdf$Value<-newqbdf$sigmaCap-newqbdf$sigmaQPM
newqbdf[order(-newqbdf$Value)]
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf$sigmaQPM<-scale(newqbdf$QPM)
newqbdf$sigmaCap<-scale(newqbdf$Cap)
newqbdf$Value<-newqbdf$sigmaCap-newqbdf$sigmaQPM
newqbdf
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf$sigmaQPM<-scale(newqbdf$QPM)
newqbdf$sigmaCap<-scale(newqbdf$Cap)
newqbdf$Value<-newqbdf$sigmaCap-newqbdf$sigmaQPM
newqbdf<-newqbdf[order(-newqbdf$Value), ]
newqbdf
capDF<-read.csv('qbcaps.csv')
names(capDF)[names(capDF) == 'Name'] <- 'Passer'
capDF
install.packages("dummies")
install.packages("ggplot2")
install.packages("dummies")
install.packages("stringr")
install.packages("plyr")
library(ggplot2)
library(data.table)
library(dummies)
library(stringr)
library(plyr)
setwd("C:\\Users\\Owner\\Desktop\\gitstuff\\Projects\\nflPlayByPlay")
df <- read.csv(file = "NFLPlaybyPlay2015.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
df
install.packages("dummies")
a<-0.50 #rushingyds multiplier
b<-0.5 #rushingtd multiplier
c<-1 #completion multiplier
d<-2 #passingyds multiplier
e<-4 #passingtd multiplier
f<-3 #passing1d multiplier
g<-2 #rushing1d multiplier
h<-100 #playkill multiplier
k<-0.025 #sack multiplier
l<-0.5 #fumble multiplier
newqbdf$QPM<-(((a*newqbdf$Rushing.Yards+b*newqbdf$Rushing.Touchdown)/newqbdf$RushAttempt)+((c*newqbdf$PassOutcome.Complete+d*newqbdf$Passing.Yards+e*newqbdf$Passing.Touchdown)/newqbdf$PassAttempt)+((f*newqbdf$Passing.FirstDown)/newqbdf$PassAttempt+(g*newqbdf$Rushing.FirstDown)/newqbdf$RushAttempt)-(h*(k*newqbdf$Sack+l*newqbdf$Fumble+newqbdf$InterceptionThrown)/(newqbdf$RushAttempt+newqbdf$PassAttempt))-15.6)
newqbdf<-newqbdf[order(-newqbdf$QPM), ]
rownames(newqbdf) <- 1:nrow(newqbdf)
newqbdf
capDF<-read.csv('qbcaps.csv')
names(capDF)[names(capDF) == 'Name'] <- 'Passer'
capDF
